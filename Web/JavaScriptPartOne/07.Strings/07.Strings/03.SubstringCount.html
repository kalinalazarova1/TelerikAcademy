<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Substring Count</title>
    <link href="js-console.min.css" rel="stylesheet" />
</head>
<body>
    <!--Write a JavaScript function that finds how many times a substring is contained
         in a given text (perform case insensitive search).-->
    <div id="js-console">
        <label for="input1">Input text and press Enter: </label>
        <input type="text" id="input1" onkeydown="onEnterKeyPressed(event)" />
        <br />
        <label for="input2">Input search substring and press Enter: </label>
        <input type="text" id="input2" onkeydown="onEnterKeyPressed(event)" />
        <br />
    </div>
    <script src="js-console.js"></script>
    <script>
        window.onload = function () {
            document.getElementById("input1").focus();
        }

        function substringCountTest() {      //tests substringCount() function
            var text = jsConsole.read("input#input1");
            var substring = jsConsole.read("input#input2");
            jsConsole.writeLine("The substring(case-insensitive search): &quot" + substring + "&quot is found " + substringCount(text, substring) + (substringCount(text, substring) == 1 ? " time." : " times."));
        }

        function substringCount(text, substring) {
            var substrings = text.toLowerCase().split(substring.toLowerCase());       //the text is splitted by the search substring
            return substrings.length - 1;                 //the number of pieces after the split minus one are the count of the occurances of the searched substring
        };

        function onEnterKeyPressed(event) {
            if (event.keyCode == 13) {
                if (document.activeElement == document.getElementById("input1")) {
                    document.getElementById("input2").focus();
                }
                else {
                    substringCountTest();
                }
            }
        }
    </script>
</body>
</html>